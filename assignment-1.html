<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>程式教學</title>
    <!-- Ionic CDN -->
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"
    ></script>
    <script
      nomodule
      src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"
    />
    <style>
      html {
        font-size: 16px;
      }
      ion-content {
        --padding-top: 0;
      }
      .lang-header {
        letter-spacing: 0.03em;
        margin-top: 2rem;
        margin-bottom: 1.5rem;
        margin-left: 0;
        margin-right: 0;
        border-radius: 0.5rem;
        box-shadow: 0 0.0625rem 0.25rem #0001;
        padding: 0.5em 1em;
        font-size: 1.15em;
        font-weight: bold;
        display: block;
        min-width: 7.5rem;
        background: #3572a5;
        z-index: 1;
        position: relative;
      }
      .item-row {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        margin-bottom: 3rem;
        justify-content: flex-start;
      }
      .item-card {
        background: #fff;
        border-radius: 0.75rem;
        box-shadow: 0 0.125rem 0.5rem #0002;
        padding: 0.7em 0.7em 0.7em 0.7em;
        flex: 1 1 0;
        min-width: 25rem;
        max-width: 40rem;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        margin: 0;
        height: 10rem;
        box-sizing: border-box;
      }
      .item-content {
        display: flex;
        flex-direction: row;
        align-items: stretch;
        gap: 1.2rem;
        width: 100%;
        height: 100%;
      }
      .media-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 0.7rem;
        min-width: 8.75rem;
        max-width: 11.25rem;
        width: 11.25rem;
        height: 100%;
        justify-content: center;
      }
      .media-img {
        width: 8.75rem;
        height: 6.25rem;
        object-fit: cover;
        border-radius: 0.5rem;
        border: 1px solid #eee;
        background: #f8f8f8;
      }
      .media-video,
      .media-iframe {
        width: 8.75rem;
        height: 5rem;
        border-radius: 0.5rem;
        border: 1px solid #eee;
        background: #000;
      }
      .item-info {
        flex: 1 1 0;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: stretch;
        min-width: 0;
        overflow: hidden;
        gap: 0.4rem;
      }
      .item-info-row {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 0.8rem;
        width: 100%;
      }
      .item-info-col {
        flex: 1 1 0;
        min-width: 0;
        max-width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }
      .item-title,
      .item-subtitle,
      .item-details,
      .tag-container {
        white-space: normal;
        overflow-wrap: break-word;
        word-break: break-all;
        overflow: visible;
        text-overflow: initial;
        margin-bottom: 0.2em;
        font-size: 1em;
        width: 100%;
      }
      .item-title {
        font-weight: bold;
        font-size: 1.08em;
      }
      .item-subtitle {
        color: var(--ion-color-medium);
        font-size: 0.97em;
      }
      .item-details {
        color: #444;
        font-size: 0.97em;
      }
      .tag-container {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
        align-items: center;
        min-width: 0;
        width: 100%;
        overflow-wrap: break-word;
        word-break: break-all;
      }
      .reset-chip {
        margin-left: 0.7em;
        cursor: pointer;
        user-select: none;
      }
      @media (max-width: 1200px) {
        .item-card {
          min-width: 18rem;
          max-width: 95vw;
        }
        .item-info {
          gap: 0.5rem;
        }
      }
      @media (max-width: 900px) {
        .item-row {
          flex-direction: column;
          gap: 1.2rem;
        }
        .item-card {
          min-width: 0;
          max-width: 100%;
          flex-direction: column;
          height: auto;
        }
        .item-content {
          flex-direction: column;
          gap: 0.7rem;
          height: auto;
        }
        .item-info {
          flex-direction: column;
          gap: 0.4rem;
        }
        .media-container {
          flex-direction: row;
          width: 100%;
          max-width: 100vw;
          min-width: 0;
          height: auto;
          justify-content: flex-start;
        }
        .media-img,
        .media-video,
        .media-iframe {
          width: 7.5rem;
          height: 5rem;
        }
      }
      @media (max-width: 430px) {
        .item-card {
          min-width: 0;
          max-width: 100vw;
          padding: 0.4em 0.2em;
          height: auto;
        }
        .item-content {
          flex-direction: column;
          gap: 0.5rem;
          height: auto;
        }
        .media-container {
          flex-direction: row;
          width: 100%;
          max-width: 100vw;
          min-width: 0;
          height: auto;
          justify-content: flex-start;
          gap: 0.5rem;
        }
        .media-img,
        .media-video,
        .media-iframe {
          width: 5.6rem;
          height: 3.75rem;
        }
        .item-info-row {
          flex-direction: column;
          gap: 0.2rem;
        }
        .item-info-col {
          width: 100%;
          min-width: 0;
        }
        .item-title,
        .item-subtitle,
        .item-details,
        .tag-container {
          font-size: 0.95em;
        }
      }
      @media (max-width: 340px) {
        .item-card {
          padding: 0.2em 0.1em;
        }
        .media-img,
        .media-video,
        .media-iframe {
          width: 4.4rem;
          height: 2.8rem;
        }
        .item-title,
        .item-subtitle,
        .item-details,
        .tag-container {
          font-size: 0.9em;
        }
      }
    </style>
  </head>
  <body>
    <ion-app>
      <ion-header>
        <ion-toolbar>
          <ion-title> 程式教學 </ion-title>
        </ion-toolbar>
        <ion-searchbar placeholder="搜尋..."></ion-searchbar>
        <ion-item>
          <ion-select label="分類" interface="popover"></ion-select>
          <ion-chip color="tertiary" class="reset-chip">重設</ion-chip>
        </ion-item>
      </ion-header>
      <ion-content>
        <ion-list></ion-list>
      </ion-content>
    </ion-app>
    <script>
      // 資料初始化（20 筆，內容合理且有意義）
      const items = [
        {
          title: "Python 基礎入門",
          language: "Python 3",
          level: "入門",
          details:
            "從零開始學習 Python 程式設計，包含變數、流程控制、函式等基礎概念。",
          category: "程式入門",
          tags: ["Python", "程式設計", "入門課程"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/pD4Ga6aIN0c/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=pD4Ga6aIN0c",
        },
        {
          title: "JavaScript 前端開發",
          language: "JavaScript",
          level: "入門",
          details: "學習網頁互動、DOM 操作與 ES6 語法。",
          category: "前端開發",
          tags: ["JavaScript", "網頁", "前端"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/0FLkwZ-PH2I/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=0FLkwZ-PH2I",
        },
        {
          title: "React 基礎實作",
          language: "JavaScript",
          level: "進階",
          details: "掌握 React 元件、props、state 與生命週期。",
          category: "前端開發",
          tags: ["React", "前端", "元件化"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/aBTiZfShe-4/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=aBTiZfShe-4&t=4321s",
        },
        {
          title: "資料結構與演算法",
          language: "Python 3",
          level: "進階",
          details: "介紹常見資料結構與演算法，提升解題能力。",
          category: "演算法",
          tags: ["資料結構", "演算法", "LeetCode"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/WNN2-jw1EVU/hqdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=WNN2-jw1EVU",
        },
        {
          title: "Android App 開發",
          language: "Kotlin",
          level: "入門",
          details: "使用 Kotlin 開發 Android 行動應用程式。",
          category: "行動開發",
          tags: ["Android", "Kotlin", "App"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/6pJqYvge8TY/sddefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl:
            "https://www.youtube.com/watch?v=6pJqYvge8TY&list=PLPh5-KovAYtFyX5elSTT9wEMt0HxMhR7L",
        },
        {
          title: "iOS App 開發",
          language: "Swift",
          level: "入門",
          details: "學習 Swift 與 iOS App 開發基礎。",
          category: "行動開發",
          tags: ["iOS", "Swift", "App"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/QEt2EpfaYbs/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=QEt2EpfaYbs",
        },
        {
          title: "資料庫設計與 SQL",
          language: "SQL",
          level: "入門",
          details: "學習資料庫設計、查詢語法與資料操作。",
          category: "資料庫",
          tags: ["SQL", "資料庫", "查詢"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/19TsIFHaEec/hq720.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=19TsIFHaEec",
        },
        {
          title: "Node.js 後端開發",
          language: "JavaScript",
          level: "進階",
          details: "使用 Node.js 建立 RESTful API 與伺服器應用。",
          category: "後端開發",
          tags: ["Node.js", "API", "後端"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/Lx11PEXpkSU/sddefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl:
            "https://www.youtube.com/watch?v=Lx11PEXpkSU&list=PL91gvBcdjUtZVtROM5MY-DTlk4pfnqbm_",
        },
        {
          title: "Git 版本控制",
          language: "工具",
          level: "入門",
          details: "學習 Git 基本指令與版本管理流程。",
          category: "工具",
          tags: ["Git", "版本控制", "協作"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/FKXRiAiQFiY/hqdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=FKXRiAiQFiY",
        },
        {
          title: "Linux 系統操作",
          language: "Linux",
          level: "入門",
          details: "掌握 Linux 常用指令與系統管理。",
          category: "系統",
          tags: ["Linux", "系統管理", "命令列"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/qVOCJMBwNXU/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=qVOCJMBwNXU",
        },
        {
          title: "C++ 程式設計",
          language: "C++",
          level: "入門",
          details: "學習 C++ 基礎語法與物件導向設計。",
          category: "程式入門",
          tags: ["C++", "物件導向", "程式設計"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/NF2rz5jNY5M/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=NF2rz5jNY5M",
        },
        {
          title: "Java 程式設計",
          language: "Java",
          level: "入門",
          details: "Java 語法、類別、物件與例外處理。",
          category: "程式入門",
          tags: ["Java", "物件導向", "程式設計"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/evIGdOzKCYk/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl:
            "https://www.youtube.com/watch?v=evIGdOzKCYk&list=PLTb8yNz82VDW-Ka3DMZUvhf16zZCPFiGe",
        },
        {
          title: "網頁設計基礎",
          language: "HTML/CSS",
          level: "入門",
          details: "學習 HTML5 與 CSS3 製作響應式網頁。",
          category: "前端開發",
          tags: ["HTML", "CSS", "網頁設計"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/6HHN0G2cwBM/sddefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=6HHN0G2cwBM",
        },
        {
          title: "Vue.js 前端框架",
          language: "JavaScript",
          level: "進階",
          details: "掌握 Vue.js 元件、資料綁定與路由。",
          category: "前端開發",
          tags: ["Vue.js", "前端", "框架"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/t7Px_M4SbRQ/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl:
            "https://www.youtube.com/watch?v=t7Px_M4SbRQ&list=PL-g0fdC5RMbq2EbkoiXF2vztGEcoDJoH5",
        },
        {
          title: "Flutter 跨平台開發",
          language: "Dart",
          level: "進階",
          details: "使用 Flutter 開發 iOS/Android 跨平台 App。",
          category: "行動開發",
          tags: ["Flutter", "Dart", "跨平台"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/6JcNm-JYZpw/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=6JcNm-JYZpw",
        },
        {
          title: "機器學習入門",
          language: "Python 3",
          level: "進階",
          details: "機器學習基本概念與 scikit-learn 實作。",
          category: "人工智慧",
          tags: ["機器學習", "AI", "Python"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/wm9yR1VspPs/hqdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=wm9yR1VspPs",
        },
        {
          title: "深度學習基礎",
          language: "Python 3",
          level: "進階",
          details: "深度學習理論與 TensorFlow 實作。",
          category: "人工智慧",
          tags: ["深度學習", "TensorFlow", "AI"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/_PrTJcgKrdk/sddefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=PCgea_z8x8w",
        },
        {
          title: "網路安全基礎",
          language: "工具",
          level: "入門",
          details: "資安基本觀念與常見攻擊手法。",
          category: "資安",
          tags: ["資安", "網路安全", "防護"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/Uodr22UUEBk/hq720.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=Uodr22UUEBk",
        },
        {
          title: "雲端運算與 AWS",
          language: "工具",
          level: "進階",
          details: "AWS 雲端服務與部署實務。",
          category: "雲端",
          tags: ["AWS", "雲端", "部署"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/Uv-e1RO0lrg/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=Uv-e1RO0lrg",
        },
        {
          title: "資料視覺化",
          language: "Python 3",
          level: "進階",
          details: "使用 Matplotlib、Seaborn 製作圖表。",
          category: "資料分析",
          tags: ["資料視覺化", "Python", "圖表"],
          imageUrl:
            "https://images.weserv.nl/?url=i.ytimg.com/vi/p4pqSTANWRo/maxresdefault.jpg&w=800&h=800&fit=contain&output=jpg&q=85&il&n=-1",
          videoUrl: "https://www.youtube.com/watch?v=p4pqSTANWRo",
        },
      ];

      // 狀態
      let currentCategory = "";
      let currentSearch = "";

      // 過濾資料
      function filterItems() {
        return items.filter((item) => {
          const categoryMatch =
            !currentCategory ||
            currentCategory === "" ||
            currentCategory === "全部" ||
            item.category === currentCategory;
          const search = currentSearch.trim().toLowerCase();
          if (!search) return categoryMatch;
          const inTitle = item.title.toLowerCase().includes(search);
          const inTags = item.tags.some((tag) =>
            tag.toLowerCase().includes(search)
          );
          const inDetails = item.details.toLowerCase().includes(search);
          const inLang = item.language.toLowerCase().includes(search);
          return categoryMatch && (inTitle || inTags || inDetails || inLang);
        });
      }

      function getYouTubeId(url) {
        try {
          const u = new URL(url);
          if (u.hostname.includes("youtube.com") && u.searchParams.get("v")) {
            return u.searchParams.get("v");
          }
          if (u.hostname === "youtu.be") {
            return u.pathname.slice(1);
          }
        } catch (e) {}
        return null;
      }

      function groupByLanguage(items) {
        const groups = {};
        items.forEach((item) => {
          if (!groups[item.language]) groups[item.language] = [];
          groups[item.language].push(item);
        });
        return groups;
      }

      function getLanguageColor(lang) {
        // 可根據語言自訂顏色
        const map = {
          "Python 3": "#3572A5",
          JavaScript: "#E7E600",
          Kotlin: "#7F52FF",
          Swift: "#4BB900",
          SQL: "#CEEDF8",
          Linux: "#9AE7C5",
          "C++": "#0B0C0E",
          Java: "#FFC801",
          "HTML/CSS": "#E65802",
          Dart: "#220186",
          工具: "#888",
        };
        return map[lang] || "#666";
      }

      function updateList() {
        const list = document.querySelector("ion-list");
        list.innerHTML = "";
        const filtered = filterItems();
        if (filtered.length === 0) {
          list.innerHTML = `<ion-item><div style="width:100%;text-align:center;color:#888;">查無資料</div></ion-item>`;
          return;
        }
        const groups = groupByLanguage(filtered);
        Object.keys(groups).forEach((lang) => {
          // 語言分組標題
          const header = document.createElement("div");
          header.className = "lang-header";
          header.style.background = getLanguageColor(lang);
          header.style.color = "#fff";
          header.style.fontWeight = "bold";
          header.style.fontSize = "1.15em";
          header.style.padding = "0.5em 1em";
          header.style.margin = "1.2em 0 0.5em 0";
          header.style.borderRadius = "8px";
          header.textContent = lang;
          list.appendChild(header);

          // 分組內容以 row 方式顯示，每排最多 3 個，橫向設計
          const itemsArr = groups[lang];
          for (let i = 0; i < itemsArr.length; i += 3) {
            const row = document.createElement("div");
            row.className = "item-row";
            itemsArr.slice(i, i + 3).forEach((item) => {
              const ionItem = document.createElement("div");
              ionItem.className = "item-card";
              const ytId = getYouTubeId(item.videoUrl);
              ionItem.innerHTML = `
                <div class="item-content">
                  <div class="media-container">
                    <img class="media-img" src="${item.imageUrl}" alt="${
                item.title
              }" loading="lazy" />
                    ${
                      ytId
                        ? `<iframe class="media-iframe" src="https://www.youtube.com/embed/${ytId}" frameborder="0" allowfullscreen title="YouTube影片"></iframe>`
                        : `<video class="media-video" src="${item.videoUrl}" controls></video>`
                    }
                  </div>
                  <div class="item-info">
                    <div class="item-info-row">
                      <div class="item-info-col">
                        <div class="item-title">${item.title}</div>
                      </div>
                      <div class="item-info-col">
                        <div class="item-subtitle">${item.language}｜${
                item.level
              }</div>
                      </div>
                    </div>
                    <div class="item-info-row">
                      <div class="item-info-col">
                        <div class="item-details">${item.details}</div>
                      </div>
                      <div class="item-info-col">
                        <div class="tag-container">
                          <ion-chip color="primary" size="small" style="cursor:pointer">${
                            item.category
                          }</ion-chip>
                          ${item.tags
                            .map(
                              (tag) =>
                                `<ion-chip size="small" color="secondary">${tag}</ion-chip>`
                            )
                            .join("")}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              `;
              row.appendChild(ionItem);
            });
            list.appendChild(row);
          }
        });
      }

      function updateCategoryOptions() {
        const select = document.querySelector("ion-select");
        const categories = Array.from(new Set(items.map((i) => i.category)));
        select.innerHTML =
          `<ion-select-option value="">全部</ion-select-option>` +
          categories
            .map(
              (c) => `<ion-select-option value="${c}">${c}</ion-select-option>`
            )
            .join("");
        // 保持選中狀態
        select.value = currentCategory || "";
      }

      document.addEventListener("DOMContentLoaded", () => {
        updateCategoryOptions();
        updateList();

        const searchbar = document.querySelector("ion-searchbar");
        searchbar.addEventListener("ionInput", (event) => {
          currentSearch = event.target.value || "";
          updateList();
        });

        const categorySelect = document.querySelector("ion-select");
        categorySelect.addEventListener("ionChange", (event) => {
          currentCategory = event.target.value;
          updateList();
        });

        // 點擊類別標籤可快速過濾
        document.body.addEventListener("click", function (e) {
          const chip = e.target.closest("ion-chip");
          if (
            chip &&
            chip.textContent &&
            chip.getAttribute("color") === "primary"
          ) {
            currentCategory = chip.textContent.trim();
            updateCategoryOptions();
            updateList();
          }
          // 點擊重設
          if (
            chip &&
            chip.textContent &&
            chip.classList.contains("reset-chip")
          ) {
            currentCategory = "";
            updateCategoryOptions();
            updateList();
          }
        });
      });
    </script>
  </body>
</html>
