<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>主題清單</title>
    <!-- Ionic CDN -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css" />
    <style>
      ion-content {
        --padding-top: 0;
      }
      .item-content {
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
      }
      .item-title {
        font-weight: bold;
        font-size: 1.1em;
        margin-bottom: 0.1rem;
      }
      .item-subtitle {
        color: var(--ion-color-medium);
        font-size: 0.95em;
      }
      .item-details {
        font-size: 0.98em;
        color: #444;
      }
      .tag-container {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
        margin-top: 0.2rem;
      }
      .media-container {
        margin-top: 0.5rem;
        display: flex;
        gap: 1.5rem;
        align-items: flex-start;
        flex-wrap: wrap;
        width: 100%;
      }
      .media-img {
        width: 120px;
        min-width: 90px;
        height: 80px;
        object-fit: cover;
        border-radius: 8px;
        border: 1px solid #eee;
        flex-shrink: 0;
        background: #f8f8f8;
      }
      .media-video {
        flex: 1 1 220px;
        max-width: 420px;
        aspect-ratio: 16/9;
        border-radius: 10px;
        border: 1px solid #eee;
        background: #000;
        margin-left: 0;
      }
      .media-iframe {
        flex: 1 1 220px;
        max-width: 420px;
        aspect-ratio: 16/9;
        border-radius: 10px;
        border: 1px solid #eee;
        background: #000;
        margin-left: 0;
      }
      @media (max-width: 600px) {
        .media-container {
          flex-direction: column;
          align-items: stretch;
          gap: 0.7rem;
        }
        .media-img {
          width: 100%;
          max-width: 100vw;
          height: 120px;
        }
        .media-video,
        .media-iframe {
          width: 100%;
          max-width: 100vw;
          min-width: 0;
          aspect-ratio: 16/9;
        }
      }
      @media (min-width: 601px) and (max-width: 1024px) {
        .media-container {
          flex-direction: row;
          align-items: flex-start;
          gap: 1.2rem;
        }
        .media-img {
          width: 120px;
          height: 90px;
        }
        .media-video,
        .media-iframe {
          max-width: 320px;
          aspect-ratio: 16/9;
        }
      }
      @media (min-width: 1025px) {
        .media-container {
          flex-direction: row;
          align-items: flex-start;
          gap: 2rem;
        }
        .media-img {
          width: 140px;
          height: 100px;
        }
        .media-video,
        .media-iframe {
          max-width: 480px;
          aspect-ratio: 16/9;
        }
      }
    </style>
  </head>
  <body>
    <ion-app>
      <ion-header>
        <ion-toolbar>
          <ion-title>主題清單</ion-title>
        </ion-toolbar>
        <ion-searchbar placeholder="搜尋..."></ion-searchbar>
        <ion-item>
          <ion-select label="分類" interface="popover"></ion-select>
        </ion-item>
      </ion-header>
      <ion-content>
        <ion-list></ion-list>
      </ion-content>
    </ion-app>
    <script>
      // 資料初始化（20 筆，內容合理且有意義）
      const items = [
        {
          title: "Python 基礎入門",
          language: "Python 3",
          level: "入門",
          details: "從零開始學習 Python 程式設計，包含變數、流程控制、函式等基礎概念。",
          category: "程式入門",
          tags: ["Python", "程式設計", "入門課程"],
          imageUrl: "https://oss.py.cn/pycn/upload/course/000/000/003/5a162d633d57b659.jpg",
          videoUrl: "https://www.youtube.com/watch?v=pD4Ga6aIN0c",
        },
        {
          title: "JavaScript 前端開發",
          language: "JavaScript",
          level: "入門",
          details: "學習網頁互動、DOM 操作與 ES6 語法。",
          category: "前端開發",
          tags: ["JavaScript", "網頁", "前端"],
          imageUrl: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?fit=crop&w=400&q=80",
          videoUrl: "videos/js-frontend.mp4",
        },
        {
          title: "React 基礎實作",
          language: "JavaScript",
          level: "進階",
          details: "掌握 React 元件、props、state 與生命週期。",
          category: "前端開發",
          tags: ["React", "前端", "元件化"],
          imageUrl: "https://images.unsplash.com/photo-1519389950473-47ba0277781c?fit=crop&w=400&q=80",
          videoUrl: "videos/react-basic.mp4",
        },
        {
          title: "資料結構與演算法",
          language: "Python 3",
          level: "進階",
          details: "介紹常見資料結構與演算法，提升解題能力。",
          category: "演算法",
          tags: ["資料結構", "演算法", "LeetCode"],
          imageUrl: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?fit=crop&w=400&q=80",
          videoUrl: "videos/algorithm.mp4",
        },
        {
          title: "Android App 開發",
          language: "Kotlin",
          level: "入門",
          details: "使用 Kotlin 開發 Android 行動應用程式。",
          category: "行動開發",
          tags: ["Android", "Kotlin", "App"],
          imageUrl: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?fit=crop&w=400&q=80",
          videoUrl: "videos/android.mp4",
        },
        {
          title: "iOS App 開發",
          language: "Swift",
          level: "入門",
          details: "學習 Swift 與 iOS App 開發基礎。",
          category: "行動開發",
          tags: ["iOS", "Swift", "App"],
          imageUrl: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?fit=crop&w=400&q=80",
          videoUrl: "videos/ios.mp4",
        },
        {
          title: "資料庫設計與 SQL",
          language: "SQL",
          level: "入門",
          details: "學習資料庫設計、查詢語法與資料操作。",
          category: "資料庫",
          tags: ["SQL", "資料庫", "查詢"],
          imageUrl: "https://images.unsplash.com/photo-1519389950473-47ba0277781c?fit=crop&w=400&q=80",
          videoUrl: "videos/sql.mp4",
        },
        {
          title: "Node.js 後端開發",
          language: "JavaScript",
          level: "進階",
          details: "使用 Node.js 建立 RESTful API 與伺服器應用。",
          category: "後端開發",
          tags: ["Node.js", "API", "後端"],
          imageUrl: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?fit=crop&w=400&q=80",
          videoUrl: "videos/nodejs.mp4",
        },
        {
          title: "Git 版本控制",
          language: "工具",
          level: "入門",
          details: "學習 Git 基本指令與版本管理流程。",
          category: "工具",
          tags: ["Git", "版本控制", "協作"],
          imageUrl: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?fit=crop&w=400&q=80",
          videoUrl: "videos/git.mp4",
        },
        {
          title: "Linux 系統操作",
          language: "Linux",
          level: "入門",
          details: "掌握 Linux 常用指令與系統管理。",
          category: "系統",
          tags: ["Linux", "系統管理", "命令列"],
          imageUrl: "https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?fit=crop&w=400&q=80",
          videoUrl: "videos/linux.mp4",
        },
        {
          title: "C++ 程式設計",
          language: "C++",
          level: "入門",
          details: "學習 C++ 基礎語法與物件導向設計。",
          category: "程式入門",
          tags: ["C++", "物件導向", "程式設計"],
          imageUrl: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?fit=crop&w=400&q=80",
          videoUrl: "videos/cpp.mp4",
        },
        {
          title: "Java 程式設計",
          language: "Java",
          level: "入門",
          details: "Java 語法、類別、物件與例外處理。",
          category: "程式入門",
          tags: ["Java", "物件導向", "程式設計"],
          imageUrl: "https://images.unsplash.com/photo-1519389950473-47ba0277781c?fit=crop&w=400&q=80",
          videoUrl: "videos/java.mp4",
        },
        {
          title: "網頁設計基礎",
          language: "HTML/CSS",
          level: "入門",
          details: "學習 HTML5 與 CSS3 製作響應式網頁。",
          category: "前端開發",
          tags: ["HTML", "CSS", "網頁設計"],
          imageUrl: "https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?fit=crop&w=400&q=80",
          videoUrl: "videos/web-design.mp4",
        },
        {
          title: "Vue.js 前端框架",
          language: "JavaScript",
          level: "進階",
          details: "掌握 Vue.js 元件、資料綁定與路由。",
          category: "前端開發",
          tags: ["Vue.js", "前端", "框架"],
          imageUrl: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?fit=crop&w=400&q=80",
          videoUrl: "videos/vue.mp4",
        },
        {
          title: "Flutter 跨平台開發",
          language: "Dart",
          level: "進階",
          details: "使用 Flutter 開發 iOS/Android 跨平台 App。",
          category: "行動開發",
          tags: ["Flutter", "Dart", "跨平台"],
          imageUrl: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?fit=crop&w=400&q=80",
          videoUrl: "videos/flutter.mp4",
        },
        {
          title: "機器學習入門",
          language: "Python 3",
          level: "進階",
          details: "機器學習基本概念與 scikit-learn 實作。",
          category: "人工智慧",
          tags: ["機器學習", "AI", "Python"],
          imageUrl: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?fit=crop&w=400&q=80",
          videoUrl: "videos/ml.mp4",
        },
        {
          title: "深度學習基礎",
          language: "Python 3",
          level: "進階",
          details: "深度學習理論與 TensorFlow 實作。",
          category: "人工智慧",
          tags: ["深度學習", "TensorFlow", "AI"],
          imageUrl: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?fit=crop&w=400&q=80",
          videoUrl: "videos/dl.mp4",
        },
        {
          title: "網路安全基礎",
          language: "工具",
          level: "入門",
          details: "資安基本觀念與常見攻擊手法。",
          category: "資安",
          tags: ["資安", "網路安全", "防護"],
          imageUrl: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?fit=crop&w=400&q=80",
          videoUrl: "videos/security.mp4",
        },
        {
          title: "雲端運算與 AWS",
          language: "工具",
          level: "進階",
          details: "AWS 雲端服務與部署實務。",
          category: "雲端",
          tags: ["AWS", "雲端", "部署"],
          imageUrl: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?fit=crop&w=400&q=80",
          videoUrl: "videos/aws.mp4",
        },
        {
          title: "資料視覺化",
          language: "Python 3",
          level: "進階",
          details: "使用 Matplotlib、Seaborn 製作圖表。",
          category: "資料分析",
          tags: ["資料視覺化", "Python", "圖表"],
          imageUrl: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?fit=crop&w=400&q=80",
          videoUrl: "videos/dataviz.mp4",
        },
      ];

      // 狀態
      let currentCategory = "";
      let currentSearch = "";

      // 過濾資料
      function filterItems() {
        return items.filter((item) => {
          const categoryMatch =
            !currentCategory ||
            currentCategory === "" ||
            currentCategory === "全部" ||
            item.category === currentCategory;
          const search = currentSearch.trim().toLowerCase();
          if (!search) return categoryMatch;
          const inTitle = item.title.toLowerCase().includes(search);
          const inTags = item.tags.some((tag) =>
            tag.toLowerCase().includes(search)
          );
          const inDetails = item.details.toLowerCase().includes(search);
          const inLang = item.language.toLowerCase().includes(search);
          return (
            categoryMatch &&
            (inTitle || inTags || inDetails || inLang)
          );
        });
      }

      function getYouTubeId(url) {
        try {
          const u = new URL(url);
          if (u.hostname.includes("youtube.com") && u.searchParams.get("v")) {
            return u.searchParams.get("v");
          }
          if (u.hostname === "youtu.be") {
            return u.pathname.slice(1);
          }
        } catch (e) {}
        return null;
      }

      function updateList() {
        const list = document.querySelector("ion-list");
        list.innerHTML = "";
        const filtered = filterItems();
        if (filtered.length === 0) {
          list.innerHTML = `<ion-item><div style="width:100%;text-align:center;color:#888;">查無資料</div></ion-item>`;
          return;
        }
        filtered.forEach((item) => {
          const ionItem = document.createElement("ion-item");
          ionItem.style.alignItems = "flex-start";
          const ytId = getYouTubeId(item.videoUrl);
          ionItem.innerHTML = `
            <div class="item-content">
              <div class="item-title">${item.title}</div>
              <div class="item-subtitle">${item.language}｜${item.level}</div>
              <div class="item-details">${item.details}</div>
              <div class="tag-container">
                <ion-chip color="primary" size="small">${item.category}</ion-chip>
                ${item.tags
                  .map(
                    (tag) =>
                      `<ion-chip size="small" color="secondary">${tag}</ion-chip>`
                  )
                  .join("")}
              </div>
              <div class="media-container">
                <img class="media-img" src="${item.imageUrl}" alt="${item.title}" loading="lazy" />
                ${
                  ytId
                    ? `<iframe class="media-iframe" src="https://www.youtube.com/embed/${ytId}" frameborder="0" allowfullscreen title="YouTube影片"></iframe>`
                    : `<video class="media-video" src="${item.videoUrl}" controls></video>`
                }
              </div>
            </div>
          `;
          list.appendChild(ionItem);
        });
      }

      function updateCategoryOptions() {
        const select = document.querySelector("ion-select");
        const categories = Array.from(new Set(items.map((i) => i.category)));
        select.innerHTML =
          `<ion-select-option value="">全部</ion-select-option>` +
          categories
            .map(
              (c) => `<ion-select-option value="${c}">${c}</ion-select-option>`
            )
            .join("");
      }

      document.addEventListener("DOMContentLoaded", () => {
        updateCategoryOptions();
        updateList();

        const searchbar = document.querySelector("ion-searchbar");
        searchbar.addEventListener("ionInput", (event) => {
          currentSearch = event.target.value || "";
          updateList();
        });

        const categorySelect = document.querySelector("ion-select");
        categorySelect.addEventListener("ionChange", (event) => {
          currentCategory = event.target.value;
          updateList();
        });
      });
    </script>
  </body>
</html>